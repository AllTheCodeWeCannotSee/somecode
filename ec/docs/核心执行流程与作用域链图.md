  
  ```mermaid
graph TD
    subgraph "JsEngine 核心状态 &lt当 innerFunc 执行时&gt"
        direction LR

        subgraph "执行栈 &ltCall Stack&gt"
            direction TB
            style Ctx3 fill:#9f9,stroke:#333,stroke-width:2px
            Ctx3["<b>栈顶: innerFunc 执行上下文</b>"]
            Ctx2["outerFunc 执行上下文"]
            Ctx1["全局执行上下文"]
            Ctx3 --> Ctx2 --> Ctx1
        end

        subgraph "内存中的环境与作用域链"
            direction TB
            style Env3 fill:#lightyellow,stroke:#333,stroke-width:2px
            Env3["<b>innerFunc 的词法环境</b><br/>- bindings: {}"]
            Env2["<b>outerFunc 的词法环境</b><br/>- bindings: { x: 10, z: 30, innerFunc: [Function] }"]
            Env1["<b>全局词法环境</b><br/>- bindings: { y: 20, outerFunc: [Function] }"]

            Env3 -- "outer 指针" --> Env2
            Env2 -- "outer 指针" --> Env1
            Env1 -- "outer 指针" --> Null
        end

        Ctx3 -- "指向当前环境" --> Env3
        Ctx2 -- "指向其环境" --> Env2
        Ctx1 -- "指向其环境" --> Env1
    end

    subgraph "闭包的本质：函数创建时捕获环境"
        F1["<b>outerFunc</b> 在 <b>全局环境</b> 中创建"] --> R1["其 FunctionBody、outer_env<br/>永久指向<b>全局环境</b>"]
        F2["<b>innerFunc</b> 在 <b>outerFunc环境</b> 中创建"] --> R2["其 FunctionBody、outer_env<br/>永久指向<b>outerFunc的环境</b>"]
    end

    subgraph "变量解析过程 &ltresolve_variable&gt"
        subgraph "查找 'x' &lt在 innerFunc 中&gt"
            direction TB
            L1["1、 从 innerFunc 环境开始"] --> L2{"找到 'x' 了吗?<br/>&ltNo&gt"}
            L2 --> L3["2、 沿着 outer 指针向上"]
            L3 --> L4["3、 在 outerFunc 环境中查找"] --> L5{"找到 'x' 了吗?<br/><b>&ltYes, x = 10&gt</b>"}
            L5 --> L6["<b>返回 10</b>"]
        end
        subgraph "查找 'y' &lt在 innerFunc 中&gt"
            direction TB
            M1["1、 从 innerFunc 环境开始"] --> M2{"找到 'y' 了吗?<br/>&ltNo&gt"}
            M2 --> M3["2、 沿着 outer 指针向上"]
            M3 --> M4["3、 在 outerFunc 环境中查找"] --> M5{"找到 'y' 了吗?<br/>&ltNo&gt"}
            M5 --> M6["4、 继续沿着 outer 指针向上"]
            M6 --> M7["5、 在 全局 环境中查找"] --> M8{"找到 'y' 了吗?<br/><b>&ltYes, y = 20&gt</b>"}
            M8 --> M9["<b>返回 20</b>"]
        end
    end
  ```